import type {WebEngineAPI} from "sprig/web";

export function start(api: WebEngineAPI) {
    const {
        setLegend,
        bitmap,
        map,
        setBackground,
        setMap,
        onInput,
        getFirst,
        afterInput
    } = api
    setLegend(
        ['p', bitmap`
................
................
.......000......
.......0.0......
......0..0......
......0...0.0...
....0003.30.0...
....0.0...000...
....0.05550.....
......0...0.....
.....0....0.....
.....0...0......
......000.......
......0.0.......
.....00.00......
................`],
        ['b', bitmap`
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888
8888888888888888`]
    )

    setMap(map`
p.
..`)
    setBackground('b')

    onInput('w', () => getFirst('p').y -= 1)
    onInput('s', () => getFirst('p').y += 1)
    onInput('a', () => getFirst('p').x -= 1)
    onInput('d', () => getFirst('p').x += 1)
}
